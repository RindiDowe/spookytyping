<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spooky Typing Adventure</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #2d1b69 0%, #11001c 100%);
            color: #fff;
            min-height: 100%;
            overflow-x: hidden;
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 3.5rem;
            color: #ff6b35;
            text-shadow: 3px 3px 0px #000;
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 3px 3px 0px #000, 0 0 20px #ff6b35; }
            to { text-shadow: 3px 3px 0px #000, 0 0 30px #ff6b35, 0 0 40px #ff6b35; }
        }

        .welcome-message {
            font-size: 1.3rem;
            color: #ffd23f;
            margin-bottom: 20px;
        }

        .instructions {
            background: rgba(255, 107, 53, 0.1);
            border: 2px solid #ff6b35;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
        }

        .instructions h3 {
            color: #ff6b35;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .instructions p {
            color: #ffd23f;
            font-size: 1.2rem;
            line-height: 1.4;
        }

        .typing-game {
            background: rgba(45, 27, 105, 0.9);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            border: 3px solid #ff6b35;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .level-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .level, .round, .score {
            background: rgba(255, 107, 53, 0.2);
            border: 2px solid #ff6b35;
            border-radius: 15px;
            padding: 15px 25px;
            font-size: 1.3rem;
            color: #ffd23f;
            font-weight: bold;
        }

        .level-description {
            text-align: center;
            font-size: 1.5rem;
            color: #ff6b35;
            margin-bottom: 30px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .typing-word {
            font-size: 4rem;
            color: #ffd23f;
            margin: 40px 0;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            font-weight: bold;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .typing-input {
            font-size: 2.5rem;
            padding: 20px;
            border: 4px solid #ff6b35;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.95);
            color: #2d1b69;
            text-align: center;
            width: 400px;
            max-width: 90%;
            font-family: inherit;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .typing-input:focus {
            outline: none;
            border-color: #ffd23f;
            box-shadow: 0 0 20px rgba(255, 210, 63, 0.5);
        }

        .feedback {
            text-align: center;
            font-size: 1.5rem;
            margin-top: 25px;
            min-height: 40px;
            font-weight: bold;
        }

        .correct-feedback {
            color: #4ade80;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .incorrect-feedback {
            color: #ef4444;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            margin-top: 30px;
            overflow: hidden;
            border: 2px solid #ff6b35;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #ffd23f);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 12px;
        }

        .level-complete {
            background: rgba(74, 222, 128, 0.2);
            border: 3px solid #4ade80;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin: 30px 0;
            animation: celebration 0.5s ease-in-out;
        }

        @keyframes celebration {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .level-complete h3 {
            color: #4ade80;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .level-complete p {
            color: #ffd23f;
            font-size: 1.3rem;
            margin-bottom: 25px;
            line-height: 1.4;
        }

        .continue-button, .play-again-button {
            background: #4ade80;
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 30px;
            font-size: 1.3rem;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .continue-button:hover, .play-again-button:hover {
            background: #22c55e;
            transform: scale(1.05);
        }

        .floating-ghosts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .ghost {
            position: absolute;
            font-size: 2.5rem;
            animation: float 6s ease-in-out infinite;
            opacity: 0.3;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-25px) rotate(8deg); }
        }

        .progress-text {
            text-align: center;
            color: #ffd23f;
            font-size: 1.1rem;
            margin-top: 10px;
            font-weight: bold;
        }

        .enter-hint {
            color: #ffd23f;
            font-size: 1rem;
            margin-top: 10px;
            opacity: 0.8;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="floating-ghosts">
   <div class="ghost" style="left: 5%; top: 20%; animation-delay: 0s;">
    üëª
   </div>
   <div class="ghost" style="left: 15%; top: 60%; animation-delay: 1s;">
    üéÉ
   </div>
   <div class="ghost" style="left: 75%; top: 15%; animation-delay: 2s;">
    üëª
   </div>
   <div class="ghost" style="left: 85%; top: 70%; animation-delay: 3s;">
    ü¶á
   </div>
   <div class="ghost" style="left: 45%; top: 80%; animation-delay: 4s;">
    üï∑Ô∏è
   </div>
   <div class="ghost" style="left: 25%; top: 30%; animation-delay: 5s;">
    üéÉ
   </div>
  </div>
  <div class="container">
   <header class="header">
    <h1 class="game-title">üéÉ Spooky Typing Adventure üéÉ</h1>
    <p class="welcome-message">Welcome, brave coder! Progress through 3 spooky levels of typing challenges!</p>
   </header>
   <div class="instructions">
    <h3>ü¶á How to Play ü¶á</h3>
    <p>Progress through 3 levels! Type what you see to advance. 12 rounds per level with increasing difficulty and points!</p>
   </div>
   <div class="typing-game">
    <div class="level-info">
     <div class="level">
      Level <span id="current-level">1</span>
     </div>
     <div class="round">
      Round <span id="current-round">1</span>/12
     </div>
     <div class="score">
      Score: <span id="typing-score">0</span> üéÉ
     </div>
    </div>
    <div class="level-description" id="level-description">
     Level 1: Single Words
    </div>
    <div class="typing-word" id="current-word">
     PUMPKIN
    </div><input type="text" class="typing-input" id="typing-input" placeholder="Type here..." autocomplete="off">
    <div class="enter-hint" id="enter-hint" style="display: none;">
     Press Enter when finished!
    </div>
    <div class="feedback" id="typing-feedback"></div>
    <div class="progress-bar">
     <div class="progress-fill" id="progress-fill"></div>
    </div>
    <div class="progress-text" id="progress-text">
     Progress: 0/12 rounds complete
    </div>
   </div>
  </div>
  <script>
        // Default configuration
        const defaultConfig = {
            game_title: "üéÉ Spooky Typing Adventure üéÉ",
            welcome_message: "Welcome, brave coder! Progress through 3 spooky levels of typing challenges!",
            instructions: "Progress through 3 levels! Type what you see to advance. 12 rounds per level with increasing difficulty and points!"
        };

        // Game state
        let typingScore = 0;
        let currentLevel = 1;
        let currentRound = 1;
        let totalRounds = 12;
        let currentTypingWord = '';
        let usedWords = [];

        // Level content for typing game
        const levelContent = {
            1: {
                name: "Level 1: Single Words",
                items: [
                    'PUMPKIN', 'GHOST', 'WITCH', 'CANDY', 'SPIDER', 'BAT', 'MOON', 'MAGIC',
                    'TRICK', 'TREAT', 'SCARY', 'SPOOKY', 'ORANGE', 'BLACK', 'COSTUME', 'CAULDRON',
                    'BROOM', 'POTION', 'SPELL', 'CREEPY', 'EERIE', 'DARK', 'NIGHT', 'SHADOW'
                ]
            },
            2: {
                name: "Level 2: Spooky Phrases",
                items: [
                    'TRICK OR TREAT', 'HAUNTED HOUSE', 'MAGIC SPELL', 'SCARY MONSTER', 
                    'WITCH HAT', 'GHOST STORY', 'PUMPKIN PATCH', 'SPIDER WEB',
                    'FULL MOON', 'BLACK CAT', 'CANDY CORN', 'SPOOKY NIGHT',
                    'MAGIC POTION', 'CREEPY CRAWLY', 'HALLOWEEN FUN', 'COSTUME PARTY',
                    'DARK FOREST', 'FLYING BROOM', 'SCARY FACE', 'ORANGE GLOW'
                ]
            },
            3: {
                name: "Level 3: Halloween Sentences",
                items: [
                    'The witch flies on her broomstick.', 'Ghosts love to say BOO!',
                    'Pumpkins glow in the dark night.', 'Spiders spin webs everywhere.',
                    'Trick or treat is so much fun!', 'The haunted house is very scary.',
                    'Black cats have magical powers.', 'Halloween candy tastes so sweet.',
                    'Monsters hide under the bed.', 'The full moon shines bright.',
                    'Witches brew magic potions.', 'Costumes make Halloween special.',
                    'Bats fly around at midnight.', 'The pumpkin patch looks spooky.',
                    'Children love Halloween night.', 'Magic spells fill the air.'
                ]
            }
        };

        // Initialize the game
        function initGame() {
            newTypingWord();
            updateProgress();
            setupTypingInput();
            document.getElementById('typing-input').focus();
        }

        function setupTypingInput() {
            const input = document.getElementById('typing-input');
            
            // For Level 3 (sentences), use Enter key to submit
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && currentLevel === 3) {
                    checkAnswer();
                }
            });
            
            // For Levels 1 and 2, check on each input
            input.addEventListener('input', function(e) {
                if (currentLevel < 3) {
                    const typed = e.target.value.toUpperCase();
                    const target = currentTypingWord.toUpperCase();
                    
                    if (typed === target) {
                        checkAnswer();
                    }
                }
            });
        }

        function checkAnswer() {
            const input = document.getElementById('typing-input');
            const typed = input.value.trim();
            let isCorrect = false;
            
            if (currentLevel === 3) {
                // For sentences, check exact match including punctuation and capitalization
                isCorrect = typed === currentTypingWord;
            } else {
                // For words and phrases, check uppercase match
                isCorrect = typed.toUpperCase() === currentTypingWord.toUpperCase();
            }
            
            if (isCorrect) {
                const points = currentLevel * 10;
                typingScore += points;
                currentRound++;
                
                document.getElementById('typing-score').textContent = typingScore;
                document.getElementById('typing-feedback').innerHTML = `üéÉ Excellent! +${points} points`;
                document.getElementById('typing-feedback').className = 'feedback correct-feedback';
                input.value = '';
                
                updateProgress();
                
                if (currentRound > totalRounds) {
                    setTimeout(() => {
                        completeLevel();
                    }, 1500);
                } else {
                    setTimeout(() => {
                        newTypingWord();
                        document.getElementById('typing-feedback').innerHTML = '';
                    }, 1500);
                }
            } else if (currentLevel === 3) {
                // Only show error feedback for Level 3 (sentences)
                document.getElementById('typing-feedback').innerHTML = 'üëª Try again! Check your spelling, capitalization, and punctuation.';
                document.getElementById('typing-feedback').className = 'feedback incorrect-feedback';
                setTimeout(() => {
                    document.getElementById('typing-feedback').innerHTML = '';
                }, 2000);
            }
        }

        function newTypingWord() {
            const levelItems = levelContent[currentLevel].items;
            let availableWords = levelItems.filter(word => !usedWords.includes(word));
            
            // If we've used all words in this level, reset the used words list
            if (availableWords.length === 0) {
                usedWords = [];
                availableWords = levelItems;
            }
            
            currentTypingWord = availableWords[Math.floor(Math.random() * availableWords.length)];
            usedWords.push(currentTypingWord);
            
            document.getElementById('current-word').textContent = currentTypingWord;
            document.getElementById('current-round').textContent = currentRound;
            document.getElementById('current-level').textContent = currentLevel;
            document.getElementById('level-description').textContent = levelContent[currentLevel].name;
            
            // Show/hide Enter hint for Level 3
            const enterHint = document.getElementById('enter-hint');
            if (currentLevel === 3) {
                enterHint.style.display = 'block';
            } else {
                enterHint.style.display = 'none';
            }
        }

        function updateProgress() {
            const progress = ((currentRound - 1) / totalRounds) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-text').textContent = `Progress: ${currentRound - 1}/12 rounds complete`;
        }

        function completeLevel() {
            if (currentLevel < 3) {
                showLevelComplete();
            } else {
                showGameComplete();
            }
        }

        function showLevelComplete() {
            const gameContainer = document.querySelector('.typing-game');
            const levelCompleteHTML = `
                <div class="level-complete">
                    <h3>üéÉ Level ${currentLevel} Complete! üéÉ</h3>
                    <p>Amazing work! You've mastered ${levelContent[currentLevel].name.toLowerCase()}!</p>
                    <p>Current Score: ${typingScore} points</p>
                    <p>Ready for the next challenge?</p>
                    <button class="continue-button" onclick="nextLevel()">Continue to Level ${currentLevel + 1}</button>
                </div>
            `;
            gameContainer.innerHTML = gameContainer.innerHTML + levelCompleteHTML;
        }

        function showGameComplete() {
            const gameContainer = document.querySelector('.typing-game');
            const gameCompleteHTML = `
                <div class="level-complete">
                    <h3>üéÉ Congratulations! üéÉ</h3>
                    <p>You've completed all 3 levels of the Spooky Typing Adventure!</p>
                    <p>Final Score: ${typingScore} points</p>
                    <p>You're a Halloween typing master!</p>
                    <button class="play-again-button" onclick="restartGame()">üéÉ Play Again üéÉ</button>
                </div>
            `;
            gameContainer.innerHTML = gameContainer.innerHTML + gameCompleteHTML;
        }

        function nextLevel() {
            currentLevel++;
            currentRound = 1;
            usedWords = []; // Reset used words for new level
            resetTypingGame();
            newTypingWord();
            updateProgress();
        }

        function restartGame() {
            currentLevel = 1;
            currentRound = 1;
            typingScore = 0;
            usedWords = []; // Reset used words for new game
            resetTypingGame();
            newTypingWord();
            updateProgress();
            document.getElementById('typing-score').textContent = typingScore;
        }

        function resetTypingGame() {
            const gameContainer = document.querySelector('.typing-game');
            gameContainer.innerHTML = `
                <div class="level-info">
                    <div class="level">Level <span id="current-level">${currentLevel}</span></div>
                    <div class="round">Round <span id="current-round">${currentRound}</span>/12</div>
                    <div class="score">Score: <span id="typing-score">${typingScore}</span> üéÉ</div>
                </div>
                
                <div class="level-description" id="level-description">${levelContent[currentLevel].name}</div>
                
                <div class="typing-word" id="current-word">PUMPKIN</div>
                
                <input type="text" class="typing-input" id="typing-input" placeholder="Type here..." autocomplete="off">
                
                <div class="enter-hint" id="enter-hint" style="display: none;">Press Enter when finished!</div>
                
                <div class="feedback" id="typing-feedback"></div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">Progress: ${currentRound - 1}/12 rounds complete</div>
            `;
            setupTypingInput();
            document.getElementById('typing-input').focus();
        }

        // Element SDK implementation
        async function onConfigChange(config) {
            const title = config.game_title || defaultConfig.game_title;
            const welcome = config.welcome_message || defaultConfig.welcome_message;
            const instructions = config.instructions || defaultConfig.instructions;

            document.querySelector('.game-title').textContent = title;
            document.querySelector('.welcome-message').textContent = welcome;
            document.querySelector('.instructions p').textContent = instructions;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || '#ff6b35',
                        set: (value) => {
                            config.primary_color = value;
                            window.elementSdk.setConfig({ primary_color: value });
                        }
                    },
                    {
                        get: () => config.secondary_color || '#ffd23f',
                        set: (value) => {
                            config.secondary_color = value;
                            window.elementSdk.setConfig({ secondary_color: value });
                        }
                    }
                ],
                borderables: [],
                fontEditable: {
                    get: () => config.font_family || 'Comic Sans MS',
                    set: (value) => {
                        config.font_family = value;
                        window.elementSdk.setConfig({ font_family: value });
                    }
                },
                fontSizeable: {
                    get: () => config.font_size || 16,
                    set: (value) => {
                        config.font_size = value;
                        window.elementSdk.setConfig({ font_size: value });
                    }
                }
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["game_title", config.game_title || defaultConfig.game_title],
                ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
                ["instructions", config.instructions || defaultConfig.instructions]
            ]);
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        // Start the game when page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995ae653b78c672e',t:'MTc2MTY1OTQwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
